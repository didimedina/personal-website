import { fileURLToPath } from "url";
import { crawlFrameworkPkgs } from "vitefu";
async function getSolidPkgsConfig(isBuild, astroConfig) {
  return await crawlFrameworkPkgs({
    root: fileURLToPath(astroConfig.root),
    isBuild,
    viteUserConfig: astroConfig.vite,
    isFrameworkPkgByJson(pkgJson) {
      return containsSolidField(pkgJson.exports || {});
    }
  });
}
function containsSolidField(fields) {
  const keys = Object.keys(fields);
  for (let i = 0; i < keys.length; i++) {
    const key = keys[i];
    if (key === "solid")
      return true;
    if (typeof fields[key] === "object" && fields[key] != null && containsSolidField(fields[key]))
      return true;
  }
  return false;
}
export {
  getSolidPkgsConfig
};
